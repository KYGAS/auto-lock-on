"use strict";module.exports=function y(l){let s=[],d=false,m={},o=[],g=[],c=[],r=[],f=[],u=[],b=[],t=-1,a=null;const n={444:[2201],3037:[2201]};const i={3105:[1e3],3205:[1e3],444:[1e3,1001,2e3,2001],3037:[1e3,1001,2e3,2001],2105:[1e3,1001,1002,1003,2e3],3102:[1e3,1001,1002,1003],3202:[1e3,1001,1002,1003]};l.command.add("autoheal",e=>{if(e)e=e.toLowerCase();if(e==null){l.settings.autoHeal=!l.settings.autoHeal}else if(e==="off"){l.settings.autoHeal=false}else if(e==="on"){l.settings.autoHeal=true}else if(e==="debug"){d=!d;l.command.message("Debug "+(d?"enabled":"disabled"));return}else if(e==="test"){G(0);return}else if(!isNaN(e)){l.settings.autoHeal=true;l.settings.hpCutoff=e<0?0:e>100?100:e}else{l.command.message(e+" is an invalid argument");return}l.command.message("Healing "+(l.settings.autoHeal?"enabled ("+l.settings.hpCutoff+"%)":"disabled"))});l.command.add("autocleanse",e=>{if(e)e=e.toLowerCase();if(e==null){l.settings.autoCleanse=!l.settings.autoCleanse}else if(e==="off"){l.settings.autoCleanse=false}else if(e==="on"){l.settings.autoCleanse=true}else{l.command.message(e+" is an invalid argument for cleanse command");return}l.command.message("Cleansing "+(l.settings.autoCleanse?"enabled":"disabled"))});l.command.add("autocast",e=>{if(e)e=e.toLowerCase();if(e==null){l.settings.autoCast=!l.settings.autoCast}else if(e==="off"){l.settings.autoCast=false}else if(e==="on"){l.settings.autoCast=true}else{l.command.message(e+" is an invalid argument for cast command");return}l.command.message("Casting "+(l.settings.autoCast?"enabled":"disabled"))});l.command.add("autodebuff",e=>{if(e)e=e.toLowerCase();if(e==null){l.settings.autoDebuff=!l.settings.autoDebuff}else if(e==="off"){l.settings.autoDebuff=false}else if(e==="on"){l.settings.autoDebuff=true}else{l.command.message(e+" is an invalid argument for cast command");return}l.command.message("Debuffing "+(l.settings.autoCast?"enabled":"disabled"))});l.command.add("autopriest",e=>{if(e)e=e.toLowerCase();if(e==null){l.command.message("UwU Hi you cute healer. These are your priest settings!");l.command.message("FH"+" : "+(l.settings.enablePriestFH?"enabled":"disabled"));l.command.message("HI"+" : "+(l.settings.enablePriestHI?"enabled":"disabled"));l.command.message("Plague"+" : "+(l.settings.enablePriestPlague?"enabled":"disabled"));l.command.message("Sleep"+" : "+(l.settings.enablePriestSleep?"enabled":"disabled"));l.command.message("EStars"+" : "+(l.settings.enablePriestES?"enabled":"disabled"))}else if(e=="fh"||e=="focus"){l.settings.enablePriestFH=!l.settings.enablePriestFH;l.command.message(e+" : "+(l.settings.enablePriestFH?"enabled":"disabled"))}else if(e=="hi"||e=="immersion"||e=="imm"||e=="healing"){l.settings.enablePriestHI=!l.settings.enablePriestHI;l.command.message(e+" : "+(l.settings.enablePriestHI?"enabled":"disabled"))}else if(e=="plague"||e=="poe"){l.settings.enablePriestPlague=!l.settings.enablePriestPlague;l.command.message(e+" : "+(l.settings.enablePriestPlague?"enabled":"disabled"))}else if(e=="sleep"){l.settings.enablePriestSleep=!l.settings.enablePriestSleep;l.command.message(e+" : "+(l.settings.enablePriestSleep?"enabled":"disabled"))}else if(e=="es"||e=="energy"||e=="estars"){l.settings.enablePriestES=!l.settings.enablePriestES;l.command.message(e+" : "+(l.settings.enablePriestES?"enabled":"disabled"))}else{l.command.message("UGGA BOOGA PEEPOPOOPEE~");l.command.message("Go read commands pepega")}});l.command.add("automystic",e=>{if(e)e=e.toLowerCase();if(e==null){l.command.message("UwU Hi you cute healer. These are your mystic settings!");l.command.message("TF"+" : "+(l.settings.enableMysticTF?"enabled":"disabled"));l.command.message("Cleanse"+" : "+(l.settings.enableMysticACT?"enabled":"disabled"));l.command.message("Sleep"+" : "+(l.settings.enableMysticSleep?"enabled":"disabled"));l.command.message("Volley"+" : "+(l.settings.enableMysticVoC?"enabled":"disabled"));l.command.message("Contagion"+" : "+(l.settings.enableMysticCont?"enabled":"disabled"));l.command.message("Wrath"+" : "+(l.settings.enableMysticToW?"enabled":"disabled"))}else if(e=="tf"){l.settings.enableMysticTF=!l.settings.enableMysticTF;l.command.message(e+" : "+(l.settings.enableMysticTF?"enabled":"disabled"))}else if(e=="act"){l.settings.enableMysticACT=!l.settings.enableMysticACT;l.command.message(e+" : "+(l.settings.enableMysticACT?"enabled":"disabled"))}else if(e=="sleep"){l.settings.enableMysticSleep=!l.settings.enableMysticSleep;l.command.message(e+" : "+(l.settings.enableMysticSleep?"enabled":"disabled"))}else if(e=="voc"){l.settings.enableMysticVoC=!l.settings.enableMysticVoC;l.command.message(e+" : "+(l.settings.enableMysticVoC?"enabled":"disabled"))}else if(e=="cont"){l.settings.enableMysticCont=!l.settings.enableMysticCont;l.command.message(e+" : "+(l.settings.enableMysticCont?"enabled":"disabled"))}else if(e=="tow"||e=="wrath"){l.settings.enableMysticToW=!l.settings.enableMysticToW;l.command.message(e+" : "+(l.settings.enableMysticToW?"enabled":"disabled"))}else{l.command.message("UGGA BOOGA PEEPOPOOPEE~");l.command.message("Go read commands pepega")}});l.game.on("enter_game",()=>{t=(l.game.me.templateId-10101)%100;l.settings.allySkills[t]||l.settings.enemySkills[t]?p():h()});function e(){s.push(l.hook(...arguments))}function h(){if(s.length){for(let e of s)l.unhook(e);s=[]}}function p(){if(!s.length){e("S_PARTY_MEMBER_LIST",9,e=>{const t=o;o=e.members.filter(e=>e.playerId!=l.game.me.playerId);if(t){for(let s=0;s<o.length;s++){const a=t.find(e=>e.playerId==o[s].playerId);if(a){o[s].gameId=a.gameId;if(a.loc)o[s].loc=a.loc}}}});e("S_LEAVE_PARTY",1,e=>{o=[]});e("C_PLAYER_LOCATION",5,e=>{m=e});e("S_SPAWN_ME",3,e=>{m.loc=e.loc;m.w=e.w});e("S_SPAWN_USER",17,s=>{if(o.length!=0){let e=o.find(e=>e.playerId===s.playerId);if(e){e.gameId=s.gameId;e.loc=s.loc;e.alive=s.alive;e.hpP=s.alive?100:0}}});e("S_USER_LOCATION",6,s=>{let e=o.find(e=>e.gameId===s.gameId);if(e)e.loc=s.loc});e("S_USER_LOCATION_IN_ACTION",2,s=>{let e=o.find(e=>e.gameId===s.gameId);if(e)e.loc=s.loc});e("S_INSTANT_DASH",3,s=>{let e=o.find(e=>e.gameId===s.gameId);if(e)e.loc=s.loc});e("S_PARTY_MEMBER_CHANGE_HP",4,s=>{if(l.game.me.playerId==s.playerId)return;let e=o.find(e=>e.playerId===s.playerId);if(e){e.hpP=Number(s.currentHp)/Number(s.maxHp)*100}});e("S_PARTY_MEMBER_STAT_UPDATE",4,s=>{if(l.game.me.playerId==s.playerId)return;let e=o.find(e=>e.playerId===s.playerId);if(e){e.hpP=Number(s.hp)/Number(s.maxHp)*100;e.alive=s.alive}});e("S_DEAD_LOCATION",2,s=>{let e=o.find(e=>e.gameId===s.gameId);if(e){e.loc=s.loc;e.hpP=0;e.alive=false}});e("S_LEAVE_PARTY_MEMBER",2,s=>{o=o.filter(e=>e.playerId!=s.playerId)});e("S_LOGOUT_PARTY_MEMBER",1,s=>{let e=o.find(e=>e.playerId===s.playerId);if(e)e.online=false});e("S_BAN_PARTY_MEMBER",1,s=>{o=o.filter(e=>e.playerId!=s.playerId)});e("S_BOSS_GAGE_INFO",3,e=>{const s=g.indexOf(e.id);if(s>-1){g.splice(s,1)}g.push(e.id)});e("S_SPAWN_NPC",12,e=>{if(n[e.huntingZoneId])if(n[e.huntingZoneId].includes(e.templateId))c.push(e.gameId);if(i[e.huntingZoneId])if(i[e.huntingZoneId].includes(e.templateId))f.push(e.gameId);u[e.gameId]=e.loc;if(e.templateId==10238008&&e.huntingZoneId==1023&&e.owner==l.game.me.gameId){b.push(e.gameId)}});e("S_ACTION_STAGE",9,e=>{if(!b.includes(e.gameId)||!l.settings.enableMysticToW)return;switch(e.skill.id){case 1101:setTimeout(()=>{l.send("C_START_SKILL",7,{skill:{reserved:0,npc:false,type:1,huntingZoneId:0,id:350100},loc:m.loc,w:m.w,unk:true,moving:true,"continue":false,target:g[0],unk2:false})},4800/e.speed);break;case 1102:setTimeout(()=>{l.send("C_START_SKILL",7,{skill:{reserved:0,npc:false,type:1,huntingZoneId:0,id:350100},loc:m.loc,w:m.w,unk:true,moving:true,"continue":false,target:g[0],unk2:false})},4054/e.speed);break;case 1103:setTimeout(()=>{l.send("C_START_SKILL",7,{skill:{reserved:0,npc:false,type:1,huntingZoneId:0,id:350100},loc:m.loc,w:m.w,unk:true,moving:true,"continue":false,target:g[0],unk2:false})},2e3/e.speed);break}});e("S_DESPAWN_NPC",3,e=>{const s=g.indexOf(e.gameId);if(s>-1){g.splice(s,1)}const t=c.indexOf(e.gameId);if(t>-1){c.splice(t,1)}const a=f.indexOf(e.gameId);if(a>-1){f.splice(a,1)}const n=r.indexOf(e.gameId);if(n>-1){r.splice(n,1)}const i=u.indexOf(e.gameId);if(i>-1){u.splice(i,1)}const l=b.indexOf(e.gameId);if(l>-1){b.splice(l,1)}});e("S_NPC_LOCATION",3,e=>{u[e.gameId]=e.loc});e("S_LOAD_TOPO","event",e=>{g=[];c=[];f=[];u=[];r=[];b=[]});e("S_ABNORMALITY_BEGIN",5,e=>{if(![30372204,90442204].includes(e.id))return;const s=c.indexOf(e.target);if(s>-1){c.splice(s,1)}const t=r.indexOf(e.target);if(t>-1){r.splice(t,1)}});e("S_ABNORMALITY_BEGIN",5,e=>{if(![90442202,30372202].includes(e.id))return;const s=c.indexOf(e.target);if(s==-1){c.push(e.target)}});e("S_ABNORMALITY_BEGIN",5,e=>{if(![701101,801202].includes(e.id))return;const s=c.indexOf(e.target);if(s>-1){r.push(c.splice(s,1)[0])}});e("S_ABNORMALITY_END",1,e=>{if(![701101,801202].includes(e.id))return;const s=r.indexOf(e.target);if(s>-1){c.push(r.splice(s,1)[0])}});e("C_START_SKILL",7,{order:-Infinity,filter:{fake:false}},n=>{if(o.length==0)return;if(n.skill.id/10&1!=0){m.w=n.w;return}let i=Math.floor(n.skill.id/1e4);if(l.settings.allySkills[t]&&l.settings.allySkills[t].includes(i)){switch(i){case 41:if(!l.settings.enableMysticCont)return;else break;case 37:if(!l.settings.enablePriestHI)return;else break;case 35:if(!l.settings.enablePriestES)return;else break;case 33:if(!l.settings.enablePriestSleep)return;else break;case 30:if(!l.settings.enablePriestPlague)return;else break;case 28:if(!l.settings.enableMysticSleep)return;else break;case 24:if(!l.settings.enableMysticVoC)return;else break;case 19:if(!l.settings.enablePriestFH)return;else break;case 9:if(!l.settings.enableMysticACT)return;else break;case 5:if(!l.settings.enableMysticTF)return;else break;default:l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");return}let t=[];let a=D(i);if(i!=9)O();for(let e=0,s=o.length;e<s;e++){if(o[e].online&&o[e].alive&&o[e].hpP!=undefined&&o[e].hpP!=0&&(i==9?true:o[e].hpP<=l.settings.hpCutoff)&&o[e].loc!=undefined&&o[e].loc.dist3D(m.loc)/25<=l.settings.maxDistance){t.push(o[e]);if(t.length==a)break}}if(t.length>0){if(d)G(n.skill);for(let e=0,s=t.length;e<s;e++){setTimeout(()=>{l.send("C_CAN_LOCKON_TARGET",3,{target:t[e].gameId,skill:n.skill.id})},l.settings.lockSpeed)}if(l.settings.autoCast){setTimeout(()=>{l.send("C_START_SKILL",7,Object.assign({},n,{w:m.w,skill:n.skill.id+10}))},Math.max(l.settings.castSpeed,l.settings.lockSpeed+10))}}}});e("C_START_SKILL",7,{order:-Infinity,filter:{fake:false}},i=>{if(i.skill.id/10&1!=0){m.w=i.w;return}let e=Math.floor(i.skill.id/1e4);if(l.settings.enemySkills[t]&&l.settings.enemySkills[t].includes(e)){let t=[];let a=D(e);switch(e){case 41:if(!l.settings.enableMysticCont)return;else break;case 37:if(!l.settings.enablePriestHI)return;else break;case 35:if(!l.settings.enablePriestES)return;else break;case 33:if(!l.settings.enablePriestSleep)return;else break;case 30:if(!l.settings.enablePriestPlague)return;else break;case 28:if(!l.settings.enableMysticSleep)return;else break;case 24:if(!l.settings.enableMysticVoC)return;else break;case 19:if(!l.settings.enablePriestFH)return;else break;case 9:if(!l.settings.enableMysticACT)return;else break;case 5:if(!l.settings.enableMysticTF)return;else break;default:l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");l.command.message("UH OH DANGER UGGA BOOGA!?!?! Contact Kygas and tell him when this happened :DDDD");return}switch(e){case 41:case 35:case 24:t=t.concat(g);break;case 30:t=t.concat(f);break;case 28:case 33:t=t.concat(c);break;default:return}if(t.length==0)return;let n=[];for(let e=0,s=t.length;e<s;e++){if(u[t[e]]!=undefined&&u[t[e]].dist3D(m.loc)/25<=l.settings.maxDistance){n.push(t[e]);if(n.length==a)break}}if(n.length>0){if(d)G(i.skill);for(let e=0,s=n.length;e<s;e++){setTimeout(()=>{l.send("C_CAN_LOCKON_TARGET",3,{target:n[e],skill:i.skill.id})},l.settings.lockSpeed)}if(l.settings.autoCast){setTimeout(()=>{l.send("C_START_SKILL",7,Object.assign({},i,{w:m.w,skill:i.skill.id+10}))},Math.max(l.settings.castSpeed,l.settings.lockSpeed+10))}}}});e("S_CREST_INFO",2,e=>{a=e.crests});e("S_CREST_APPLY",2,s=>{let e=a.find(e=>e.id==s.id);if(e)e.enable=s.enable})}}function D(e){switch(e){case 41:return 1;case 37:return 1;case 35:return 1;case 33:return 1;case 30:return 1;case 28:return 1;case 24:return A(27040)?5:4;case 19:return A(28003)?4:2;case 9:return A(27063)||A(27003)?5:3;case 5:return A(27e3)?4:2}return 1}function A(s){let e=a.find(e=>e.id==s&&e.enable);if(e)return true;else return false}function O(){o.sort(function(e,s){return parseFloat(e.hpP)-parseFloat(s.hpP)})}function G(e){let d="\nAutoheal Debug... Skill: "+e.id+"\tpartyMemebers.length: "+o.length;for(let l=0;l<o.length;l++){d+="\n"+l+"\t";let e=o[l].name;e+=" ".repeat(21-e.length);let s="\tHP: "+parseFloat(o[l].hpP).toFixed(2);let t="\tundefined";if(o[l].loc)t="\tDist: "+(o[l].loc.dist3D(m.loc)/25).toFixed(2);let a="\tOnline: "+o[l].online;let n="\tAlive: "+o[l].alive;let i="\tpid: "+o[l].playerId+"  gid: "+o[l].gameId;d+=e+s+t+a+n+i}console.log(d)}};